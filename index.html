<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marwen Ben Slimen - Services Informatiques Professionnels</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>
<body>
    <header>
        <h1>Marwen Ben Slimen - Services Informatiques Professionnels</h1>
        <nav>
            <ul>
                <li><a href="#home">Accueil</a></li>
                <li><a href="#services">Services</a></li>
                <li><a href="#about">À propos</a></li>
                <li><a href="#experience">Expériences</a></li>
                <li><a href="#education">Formations</a></li>
                <li><a href="#certifications">Certifications</a></li>
                <li><a href="#skills">Compétences</a></li>
                <li><a href="#testimonials">Témoignages</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </nav>
    </header>

    <!-- Section Accueil -->
    <section id="home">
        <div class="hero">
            <h2>Votre expert en solutions informatiques</h2>
            <p>Je vous aide à résoudre vos problèmes techniques et à optimiser vos systèmes pour une performance maximale.</p>
            <a href="#contact" class="cta-button">Contactez-moi</a>
        </div>
    </section>

    <!-- Section Services -->
    <section id="services">
        <h2>Mes Services</h2>
        <div class="service-list">
            <div class="service-item">
                <h3>Support technique</h3>
                <p>Assistance technique de niveau 1, 2 et 3 pour résoudre vos problèmes matériels et logiciels.</p>
            </div>
            <div class="service-item">
                <h3>Gestion des réseaux</h3>
                <p>Configuration, maintenance et dépannage des réseaux informatiques.</p>
            </div>
            <div class="service-item">
                <h3>Sécurité informatique</h3>
                <p>Protection des systèmes contre les menaces et gestion des accès utilisateurs.</p>
            </div>
            <div class="service-item">
                <h3>Migration vers le cloud</h3>
                <p>Migration sécurisée de vos données et applications vers des solutions cloud.</p>
            </div>
        </div>
    </section>

    <!-- Section À propos -->
    <section id="about">
        <h2>À propos de moi</h2>
        <img src="marwen.jpg" alt="Photo de Marwen Ben Slimen" class="profile-photo">
        <p>Je suis Marwen Ben Slimen, technicien informatique avec plus de 8 ans d'expérience dans la résolution de problèmes techniques et l'optimisation des systèmes. Mon objectif est de vous offrir des solutions fiables et adaptées à vos besoins.</p>
    </section>

    <!-- Section Expériences professionnelles -->
    <section id="experience">
        <h2>Expériences professionnelles</h2>
        <ul class="experience-list">
            <li>
                <img src="pjcci_logo.png" alt="Logo PJCCI" class="company-logo">
                <strong>Technicien en informatique N2 et N3</strong> - PJCCI, Montréal (2023 – actuel)
            </li>
            <li>
                <img src="drill_logo.png" alt="Logo DRILL" class="company-logo">
                <strong>Technicien en informatique N1</strong> - DRILL, Laval (2022 - 2023)
            </li>
            <li>
                <img src="techriders_logo.png" alt="Logo TechRiders" class="company-logo">
                <strong>Technicien en informatique spécialisé</strong> - TechRiders, France (2021 - 2022)
            </li>
            <li>
                <img src="gouvernement_tunisie_logo.png" alt="Logo Gouvernement Tunisie" class="company-logo">
                <strong>Technicien informatique N2</strong> - Gouvernement Tunisie, Tunisie (2015 - 2021)
            </li>
        </ul>
    </section>

    <!-- Section Formations -->
    <section id="education">
        <h2>Formations</h2>
        <ul>
            <li><strong>AEC en gestion d’infrastructure TI et Infonuagique</strong> - Collège Lionel-Groulx, Montréal (2024)</li>
            <li><strong>Baccalauréat en Réseaux et Systèmes Télécom</strong> - ISET’Com, Tunisie (2015)</li>
        </ul>
    </section>

    <!-- Section Certifications -->
    <section id="certifications">
        <h2>Certifications professionnelles</h2>
        <ul class="certification-list">
            <li>
                <a href="https://www.coursera.org/account/accomplishments/specialization/certificate/Z2ODSDMM1WJ5" target="_blank" rel="noopener noreferrer">
                    <img src="ibm_logo.png" alt="Logo IBM" class="certification-logo">
                    <strong>Certificat IBM IT Support</strong> (2025)
                </a>
            </li>
            <li>
                <a href="https://www.coursera.org/account/accomplishments/specialization/certificate/V2YQ7K7TS7AP" target="_blank" rel="noopener noreferrer">
                    <img src="microsoft_logo.png" alt="Logo Microsoft" class="certification-logo">
                    <strong>Certificat Microsoft IT Support Specialist</strong> (2024)
                </a>
            </li>
            <li>
                <a href="https://www.coursera.org/account/accomplishments/specialization/certificate/YI5KZ71ZGAZ7" target="_blank" rel="noopener noreferrer">
                    <img src="google_logo.png" alt="Logo Google" class="certification-logo">
                    <strong>Certificat Google IT Support</strong> (2024)
                </a>
            </li>
        </ul>
    </section>

    <!-- Section Compétences -->
    <section id="skills">
        <h2>Compétences</h2>
        <h3>Support aux utilisateurs et assistance technique :</h3>
        <ul>
            <li>Fournir un soutien informatique de niveau 1, 2 et 3 aux utilisateurs internes, incluant la résolution de problèmes complexes nécessitant une analyse approfondie des systèmes.</li>
            <li>Répondre aux appels et tickets d’incidents via le système de billetterie Octopus, en veillant à documenter chaque intervention pour assurer le suivi.</li>
            <li>Effectuer une assistance à distance pour diagnostiquer et résoudre les problèmes matériels et logiciels, souvent via des outils comme Microsoft Remote Desktop, Sccm et TeamViewer.</li>
            <li>Assurer un service à la clientèle de qualité, en s’assurant de répondre rapidement aux demandes, avec une communication claire et concise.</li>
            <li>Assurer le dépannage des logiciels et la réparation du matériel informatique (PC, ordinateurs portables, imprimantes, réseaux).</li>
            <li>Réaliser des révisions d’accès, en analysant et ajustant les droits d’accès des utilisateurs dans les systèmes d’information pour maintenir la sécurité.</li>
            <li>Supporter les utilisateurs dans l'utilisation de Microsoft 365, en assurant la gestion des accès et des droits au sein de Microsoft Office et Microsoft Access.</li>
            <li>Gérer les comptes utilisateurs, les groupes d’accès et les objets dans Active Directory, incluant la création, la modification et la suppression des comptes.</li>
            <li>Assister à la configuration du jeton virtuel pour les utilisateurs nécessitant un accès sécurisé aux ressources réseau.</li>
        </ul>

        <h3>Gestion des comptes et des accès :</h3>
        <ul>
            <li>Créer, modifier, archiver et supprimer les comptes utilisateurs dans Active Directory (AD) et Azure AD, en assurant une gestion complète du cycle de vie des comptes.</li>
            <li>Utiliser l’AD Manager pour automatiser et faciliter la gestion des comptes et des groupes, tout en s’assurant que les droits d’accès sont conformes aux politiques de sécurité de l’entreprise.</li>
            <li>Gérer des comptes et licences Adobe via la Console d’administration, en veillant à l’attribution correcte des licences pour les logiciels tels qu’Adobe Creative Cloud et Acrobat.</li>
            <li>Administrer de la suite Microsoft 365, incluant la gestion d’Exchange pour les boîtes aux lettres, Intune pour la gestion des appareils mobiles (MDM), Teams pour la collaboration, et Azure pour la gestion des utilisateurs et des accès.</li>
        </ul>
    </section>

    <!-- Section Témoignages -->
    <section id="testimonials">
        <h2>Témoignages</h2>
        <div class="testimonial-list">
            <div class="testimonial-item">
                <p>"Marwen a résolu un problème complexe sur notre réseau en un temps record. Je le recommande vivement !"</p>
                <p class="author">- Jean Dupont, Directeur IT</p>
            </div>
            <div class="testimonial-item">
                <p>"Un professionnel compétent et réactif. Merci pour votre excellent support technique !"</p>
                <p class="author">- Marie Curie, Gestionnaire de projet</p>
            </div>
        </div>
    </section>

    <!-- Section Contact -->
    <section id="contact">
        <h2>Contactez-moi</h2>
        <p>Vous avez un problème technique à résoudre ? Contactez-moi dès aujourd'hui !</p>
        <ul class="contact-info">
            <li><strong>Téléphone :</strong> <a href="tel:+14385263603">+1 438 526 3603</a></li>
            <li><strong>Email :</strong> <a href="mailto:marouenbenslimen88@gmail.com">marouenbenslimen88@gmail.com</a></li>
        </ul>
        <form action="https://formspree.io/f/xovvppzg" method="POST">
            <label for="name">Nom :</label>
            <input type="text" id="name" name="name" required>
            <label for="email">Email :</label>
            <input type="email" id="email" name="email" required>
            <label for="message">Message :</label>
            <textarea id="message" name="message" rows="4" required></textarea>
            <button type="submit">Envoyer</button>
        </form>
    </section>

    <footer>
        <p>&copy; 2025 - Marwen Ben Slimen. Tous droits réservés.</p>
        <p><strong>Téléphone :</strong> <a href="tel:+14385263603">+1 438 526 3603</a> | <strong>Email :</strong> <a href="mailto:marouenbenslimen88@gmail.com">marouenbenslimen88@gmail.com</a></p>
    </footer>
    <script src="script.js"></script>
    <!-- Section Commentaires -->
<section id="comments">
    <h2>Laissez un commentaire</h2>
    <form id="comment-form">
        <label for="comment-name">Nom :</label>
        <input type="text" id="comment-name" name="comment-name" required>
        
        <label for="comment-email">Email :</label>
        <input type="email" id="comment-email" name="comment-email" required>
        
        <label for="comment-text">Commentaire :</label>
        <textarea id="comment-text" name="comment-text" rows="4" required></textarea>
        
        <label for="rating">Note :</label>
        <select id="rating" name="rating">
            <option value="1">1 étoile</option>
            <option value="2">2 étoiles</option>
            <option value="3">3 étoiles</option>
            <option value="4">4 étoiles</option>
            <option value="5">5 étoiles</option>
        </select>
        
        <button type="submit">Envoyer</button>
    </form>
    <div id="comment-list"></div>
</section>
    <!-- Section Ressources -->
<section id="ressources">
    <h2>Ressources Utiles</h2>
    <ul>
        <li><a href="https://www.freecodecamp.org/" target="_blank">FreeCodeCamp</a> - Apprenez à coder gratuitement.</li>
        <li><a href="https://www.coursera.org/" target="_blank">Coursera</a> - Cours en ligne certifiants.</li>
        <li><a href="https://github.com/" target="_blank">GitHub</a> - Plateforme de développement collaboratif.</li>
        <li><a href="https://stackoverflow.com/" target="_blank">Stack Overflow</a> - Forum pour les développeurs.</li>
        <li><a href="https://www.udemy.com/" target="_blank">Udemy</a> - Cours en ligne payants.</li>
    </ul>
</section>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <li><i class="fas fa-code"></i> <a href="https://www.freecodecamp.org/" target="_blank">FreeCodeCamp</a></li>
<!-- ===== IA Engine (Transformers.js) ===== -->
<script src="https://cdn.jsdelivr.net/npm/@xenova/transformers/dist/transformers.min.js"></script>

<!-- ===== Chatbot IA (Marwen IT Help) ===== -->
<div id="itbot-root" aria-live="polite">
  <!-- Bouton flottant (visible quand la fenêtre est fermée) -->
  <button id="itbot-toggle" aria-haspopup="dialog" aria-controls="itbot-window" aria-label="Ouvrir le chatbot">
    <i class="fa-solid fa-comments" aria-hidden="true"></i>
    <span class="itbot-fallback" aria-hidden="true">💬</span>
  </button>

  <!-- Fenêtre de chat -->
  <div id="itbot-window" role="dialog" aria-modal="false" aria-labelledby="itbot-title" hidden>
    <header class="itbot-header">
      <div>
        <strong id="itbot-title">Marwen – Aide IT (IA locale)</strong>
        <div class="itbot-subtitle">Wi-Fi, imprimantes, AD, VPN, Outlook, Teams…</div>
      </div>
      <!-- IMPORTANT: type="button" -->
      <button id="itbot-close" type="button" aria-label="Fermer (Échap)">
        <i class="fa-solid fa-xmark" aria-hidden="true"></i>
      </button>
    </header>

    <main id="itbot-messages" class="itbot-scroll" tabindex="0" aria-label="Fil des messages">
      <div class="itbot-msg itbot-bot">
        👋 Bonjour ! Je charge le modèle IA la première fois (quelques centaines de Mo).
        Pose ta question, je réponds dès que je suis prêt.
      </div>
    </main>

    <div class="itbot-suggestions" aria-label="Suggestions rapides">
      <button class="itbot-chip">Je n’arrive pas à me connecter au Wi-Fi</button>
      <button class="itbot-chip">Mon mot de passe AD ne fonctionne pas</button>
      <button class="itbot-chip">Ajouter une imprimante réseau</button>
      <button class="itbot-chip">Le VPN ne se connecte pas</button>
      <button class="itbot-chip">Outlook ne synchronise pas</button>
      <button class="itbot-chip">Teams caméra/micro</button>
      <button class="itbot-chip" data-q="disque plein">Espace disque plein</button>
      <button class="itbot-chip" data-q="wlanreport">Rapport Wi-Fi (wlanreport)</button>

    </div>

    <form id="itbot-form" autocomplete="off">
      <input id="itbot-input" type="text" placeholder="Écrivez votre question…" aria-label="Votre question" required />
      <button id="itbot-send" type="submit" aria-label="Envoyer">
        <i class="fa-solid fa-paper-plane" aria-hidden="true"></i>
      </button>
    </form>

    <footer class="itbot-footer">
      <small>Besoin d’un humain ? <a href="#contact" class="itbot-link">Contactez-moi</a></small>
    </footer>
  </div>
</div>

<style>
/* Cache le bouton flottant quand la fenêtre est ouverte */
#itbot-root.open #itbot-toggle { display: none; }

/* Force le masquage quand hidden est présent */
#itbot-window[hidden] { display: none !important; }

#itbot-root { position: fixed; bottom: 24px; right: 24px; z-index: 9999; font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Noto Sans",sans-serif; }

#itbot-toggle {
  width:56px; height:56px; border-radius:50%; border:none; cursor:pointer; display:grid; place-items:center;
  color:#fff; background:linear-gradient(135deg,#2563eb,#0ea5e9); box-shadow:0 10px 20px rgba(0,0,0,.18);
}
#itbot-toggle i { font-size: 20px; }
#itbot-toggle .itbot-fallback { font-size:22px; line-height:1; }

#itbot-window {
  position: fixed; bottom:92px; right:24px; width:min(380px,92vw); max-height:min(70vh,760px);
  background:#fff; border-radius:16px; border:1px solid #e5e7eb; box-shadow:0 20px 50px rgba(0,0,0,.25);
  display:flex; flex-direction:column; overflow:hidden;
}
.itbot-header { display:flex; align-items:center; justify-content:space-between; padding:12px 14px; background:#0ea5e9; color:#fff; }
.itbot-subtitle{ font-size:.85rem; opacity:.9; }
#itbot-close { background:transparent; border:none; color:#fff; cursor:pointer; font-size:1.15rem; }

#itbot-messages { padding:12px; gap:10px; display:flex; flex-direction:column; background:#f8fafc; overflow:auto; }
.itbot-msg { max-width:88%; padding:10px 12px; border-radius:12px; line-height:1.35; font-size:.95rem; white-space:pre-wrap; }
.itbot-bot  { background:#e2f2ff; border:1px solid #bfdbfe; color:#0f172a; align-self:flex-start; }
.itbot-user { background:#e5e7eb; border:1px solid #d1d5db; color:#111827; align-self:flex-end; }
.itbot-typing { opacity:.8; font-style:italic; }

.itbot-suggestions { display:flex; flex-wrap:wrap; gap:8px; padding:8px 12px; background:#fff; border-top:1px solid #eef2f7; }
.itbot-chip { border:1px solid #dbeafe; background:#f0f9ff; color:#0c4a6e; padding:6px 10px; border-radius:999px; cursor:pointer; font-size:.85rem; }

#itbot-form { display:flex; gap:8px; padding:10px; background:#fff; border-top:1px solid #eef2f7; }
#itbot-input { flex:1; padding:10px 12px; border-radius:10px; border:1px solid #cbd5e1; font-size:.95rem; }
#itbot-send { width:44px; border-radius:10px; border:1px solid #bae6fd; background:#e0f2fe; color:#075985; cursor:pointer; }
#itbot-send[disabled] { opacity:.6; cursor:not-allowed; }

.itbot-footer { padding:6px 12px 10px; background:#fff; border-top:1px solid #eef2f7; text-align:right; }
.itbot-link { color:#0ea5e9; text-decoration: underline; }

@media (prefers-reduced-motion:no-preference){
  #itbot-window{ animation: itbot-pop .18s ease-out; }
  @keyframes itbot-pop { from{ transform: translateY(8px); opacity:.0 } to{ transform: translateY(0); opacity:1 } }
}
</style>

<script>
(function(){
  const el = {
    root:   document.getElementById('itbot-root'),
    toggle: document.getElementById('itbot-toggle'),
    win:    document.getElementById('itbot-window'),
    close:  document.getElementById('itbot-close'),
    messages: document.getElementById('itbot-messages'),
    form:   document.getElementById('itbot-form'),
    input:  document.getElementById('itbot-input'),
    send:   document.getElementById('itbot-send'),
    chips:  document.querySelectorAll('.itbot-chip'),
  };

      /* ===== KB — Réponses instantanées ===== */
const KB = [
  // 1) Mettre le "wlanreport" tout en haut pour qu'il passe AVANT la règle Wi-Fi générique
  {
    // capte : "wlanreport", "rapport Wi-Fi", "rapport wifi", "wifi report", "diagnostic wifi"
    // gère les tirets Unicode (‐ – —) et les espaces divers
    re: /wlanreport|rapport\s*wi[\-\u2011\u2013\u2014]?\s*fi|rapport\s*wifi|wifi\s*report|diagnostic\s*wi[\-\u2011\u2013\u2014]?\s*fi/i,
    ans:
`📊 **Rapport détaillé Wi-Fi**
1) Ouvrir **Invite de commandes (Admin)**
2) Lancer :
   netsh wlan show wlanreport
3) Ouvrir le fichier :
   C:\\ProgramData\\Microsoft\\Windows\\WlanReport\\wlan-report-latest.html
4) Le rapport affiche :
   - Déconnexions / erreurs
   - Historique des connexions
   - Infos des adaptateurs`
  },

  // 2) Tu peux aussi garder DISM/SFC haut dans la liste
  {
    re: /dism|sfc|integrité|corruption|réparer windows|repair windows/i,
    ans:
`🛠️ **Réparer l’image Windows (DISM + SFC)**
1) Ouvrir **Invite de commandes (Admin)**
2) Vérifier / réparer l’image :
   dism /online /cleanup-image /scanhealth
   dism /online /cleanup-image /restorehealth
3) Vérifier l’intégrité des fichiers :
   sfc /scannow
4) Redémarrer le PC après la réparation`
  },

  // 3) Règle Wi-Fi générique (placée APRÈS pour ne pas "manger" wlanreport)
  {
    re: /wifi|wi-?fi|internet|reseau|réseau|connexion|connecter/i,
    ans:
`💡 **Wi-Fi (Windows)**
1) Win+A → **Mode avion OFF**
2) Paramètres → **Réseau & Internet > Wi-Fi** → Wi-Fi **ON**
3) **Oublier** le réseau puis se reconnecter
4) CMD (Admin) :
netsh winsock reset
ipconfig /flushdns
ipconfig /release
ipconfig /renew
5) Redémarrer **PC** et **routeur**`
  },

  // ——— Les autres règles inchangées ———
  {
    re: /ethernet|cable|câble|lan/i,
    ans:
`🔌 **Ethernet**
- Tester autre câble/port
- Paramètres → Réseau → Ethernet → Désactiver/Activer
- CMD (Admin) :
netsh int ip reset
netsh advfirewall reset`
  },
  {
    re: /vpn|forti|anyconnect|globalprotect|openvpn|wireguard/i,
    ans:
`🌐 **VPN**
- Vérifier **identifiants + MFA**
- **Date/heure** système correctes
- Essayer un autre réseau (partage 4G)
- Quitter/relancer l’app VPN ou redémarrer
- Vérifier **Proxy** : Paramètres > Réseau > Proxy **OFF** (si non requis)`
  },
  {
    re: /imprim/i,
    ans:
`🖨️ **Imprimante réseau**
1) Paramètres → **Bluetooth & appareils > Imprimantes & scanners** → **Ajouter**
2) Entrer **\\\\SERVEUR\\Nom** ou **IP TCP/IP**
3) Installer **pilote constructeur** si demandé
4) Si file d’attente bloquée :
net stop spooler
del /q /f %systemroot%\\System32\\spool\\PRINTERS\\*.*
net start spooler`
  },
  {
    re: /outlook|courriel|mail|exchange/i,
    ans:
`📧 **Outlook**
- Fichier → Paramètres du compte → **Réparer**
- Nouveau **profil** (Panneau de config → Courrier → Profils)
- Réindexer la recherche (Options d’indexation → **Reconstruire**)
- Réinitialiser volet :
outlook.exe /resetnavpane`
  },
  {
    re: /teams|cam(é|e)ra|micro|microphone|audio|video/i,
    ans:
`🎥 **Teams (caméra/micro)**
- Paramètres Teams → **Périphériques** (choisir micro/caméra)
- Quitter complètement (icône > clic droit > **Quitter**)
- Vider cache : %appdata%\\Microsoft\\Teams\\Cache
- Tester dans **Paramètres Windows > Système > Son**`
  },
  {
    re: /ad\b|active ?directory|mot ?de ?passe|password|verrouill/i,
    ans:
`🔐 **Mot de passe AD**
- **Ctrl+Alt+Suppr** → **Modifier le mot de passe**
- Complexité : 12+ caractères, maj/min/chiffre/symbole
- PC hors domaine : connecter le **VPN**`
  },
  {
    re: /disque|espace|storage|plein/i,
    ans:
`💽 **Espace disque**
- Nettoyage de disque (cleanmgr)
- Désinstaller apps inutiles
- Vider : %temp% et C:\\Windows\\Temp`
  },
  {
    re: /mise ?à ?jour|windows update|maj/i,
    ans:
`⬆️ **Windows Update**
- Paramètres → Mise à jour → **Rechercher**
- Réinitialiser services :
net stop wuauserv
net stop bits
del /q /f %systemroot%\\SoftwareDistribution\\*.*
net start wuauserv
net start bits`
  },
  {
    re: /nav(igateur)?|chrome|edge|firefox|internet/i,
    ans:
`🌐 **Navigateur**
- Vider cache/cookies
- Tester en **navigation privée**
- Désactiver extensions suspectes`
  }
];

   


  // Renvoie une réponse immédiate si un motif de la KB matche
  function kbAnswer(q){
    for (const it of KB){
      if (it.re.test(q)) return it.ans;
    }
    return null;
  }


  let pipe=null, loading=false, ready=false;

  const SYSTEM_PROMPT = `You are "Marwen IT Assistant", a concise and practical IT helpdesk chatbot.
Answer in the user's language (French if the user writes in French). Topics: Wi-Fi, printers, AD, VPN, Outlook/Teams, Windows.
Give short, step-by-step guidance, commands in code blocks. Never ask for passwords.`;

  const FALLBACK = [
    { re:/wifi|wi-?fi|internet|réseau|reseau/i, ans:`💡 Wi-Fi (Windows)
1) Win+A Mode avion OFF
2) Paramètres > Réseau > Wi-Fi ON
3) Oublier puis reconnecter
4) CMD (Admin):
   netsh winsock reset
   ipconfig /flushdns
5) Redémarrer PC + routeur`},
    { re:/imprim/i, ans:`🖨️ Ajouter une imprimante
Paramètres > Bluetooth et appareils > Imprimantes et scanners > Ajouter.
Réseau: \\\\serveur\\Nom ou IP (TCP/IP)`},
    { re:/vpn|forti|anyconnect|globalprotect/i, ans:`🌐 VPN
- Vérifier identifiants + MFA
- Horloge OK
- Tester un autre réseau
- Relancer l'app / redémarrer`},
  ];

  const push = (text, who, cls='')=>{
    const d=document.createElement('div');
    d.className=`itbot-msg itbot-${who} ${cls}`;
    d.textContent=text;
    el.messages.appendChild(d);
    el.messages.scrollTop = el.messages.scrollHeight;
    return d;
  };

  const open = ()=>{
    el.win.hidden = false;
    el.root.classList.add('open');      // masque le bouton 💬
    el.input.focus();
    loadModel();
  };

  const close = ()=>{
    el.win.hidden = true;               // cache la fenêtre
    el.root.classList.remove('open');   // ré-affiche le bouton 💬
    el.toggle.focus();
  };

  async function loadModel(){
    if (loading || ready) return;
    loading = true;
    try {
      pipe = await window.transformers.pipeline(
        "text-generation",
        "Xenova/Qwen2.5-0.5B-Instruct",
        { quantized: true }
      );
      ready = true;
      push("✅ IA prête. Pose ta question IT.", "bot");
    } catch(e){
      console.error(e);
      push("❌ Erreur de chargement du modèle. Je peux répondre avec des conseils de base.", "bot");
    } finally {
      loading = false;
    }
  }

  async function aiAnswer(q){
    // 1) Réponse locale instantanée si connue
    const kb = kbAnswer(q);
    if (kb) return kb;

    // 2) Sinon on passe au modèle IA (comme avant)
    if (!pipe && !loading) loadModel();

    const wait = ms => new Promise(r=>setTimeout(r,ms));
    let waited = 0;
    while(!ready && loading && waited < 20000){ await wait(250); waited += 250; }

    if (!ready){
      return "🤖 Je charge encore. Essaie un mot-clé (Wi-Fi, imprimante, VPN, Outlook, AD) ou réessaie dans quelques secondes.";
    }

    const prompt = `System: ${SYSTEM_PROMPT}\nUser: ${q}\nAssistant:`;
    try {
      const out = await pipe(prompt, { max_new_tokens:180, temperature:0.2, top_p:0.9, repetition_penalty:1.05 });
      const full = Array.isArray(out) ? out[0].generated_text : String(out);
      return full.split("Assistant:").pop().trim();
    } catch(e){
      console.error(e);
      return "⚠️ Erreur pendant la génération. Réessaie.";
    }
  }


  el.toggle.addEventListener('click', open);
  el.close.addEventListener('click', close);
  document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && !el.win.hidden) close(); });

  el.form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    const q = el.input.value.trim();
    if(!q) return;
    el.input.value='';
    el.send.disabled = true;

    push(q,'user');
    const typing = push('…','bot','itbot-typing');
    const a = await aiAnswer(q);
    typing.remove();
    push(a,'bot');
    el.send.disabled = false;
  });

el.chips.forEach(ch => ch.addEventListener('click', ()=>{
  const q = ch.dataset.q || ch.textContent.trim();
  el.input.value = q;
  el.form.requestSubmit();
}));
</script>

</body>
</html>














