<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marwen Ben Slimen - Services Informatiques Professionnels</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Marwen Ben Slimen - Services Informatiques Professionnels</h1>
        <nav>
            <ul>
                <li><a href="#home">Accueil</a></li>
                <li><a href="#services">Services</a></li>
                <li><a href="#about">√Ä propos</a></li>
                <li><a href="#experience">Exp√©riences</a></li>
                <li><a href="#education">Formations</a></li>
                <li><a href="#certifications">Certifications</a></li>
                <li><a href="#skills">Comp√©tences</a></li>
                <li><a href="#testimonials">T√©moignages</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </nav>
    </header>

    <!-- Section Accueil -->
    <section id="home">
        <div class="hero">
            <h2>Votre expert en solutions informatiques</h2>
            <p>Je vous aide √† r√©soudre vos probl√®mes techniques et √† optimiser vos syst√®mes pour une performance maximale.</p>
            <a href="#contact" class="cta-button">Contactez-moi</a>
        </div>
    </section>

    <!-- Section Services -->
    <section id="services">
        <h2>Mes Services</h2>
        <div class="service-list">
            <div class="service-item">
                <h3>Support technique</h3>
                <p>Assistance technique de niveau 1, 2 et 3 pour r√©soudre vos probl√®mes mat√©riels et logiciels.</p>
            </div>
            <div class="service-item">
                <h3>Gestion des r√©seaux</h3>
                <p>Configuration, maintenance et d√©pannage des r√©seaux informatiques.</p>
            </div>
            <div class="service-item">
                <h3>S√©curit√© informatique</h3>
                <p>Protection des syst√®mes contre les menaces et gestion des acc√®s utilisateurs.</p>
            </div>
            <div class="service-item">
                <h3>Migration vers le cloud</h3>
                <p>Migration s√©curis√©e de vos donn√©es et applications vers des solutions cloud.</p>
            </div>
        </div>
    </section>

    <!-- Section √Ä propos -->
    <section id="about">
        <h2>√Ä propos de moi</h2>
        <img src="marwen.jpg" alt="Photo de Marwen Ben Slimen" class="profile-photo">
        <p>Je suis Marwen Ben Slimen, technicien informatique avec plus de 8 ans d'exp√©rience dans la r√©solution de probl√®mes techniques et l'optimisation des syst√®mes. Mon objectif est de vous offrir des solutions fiables et adapt√©es √† vos besoins.</p>
    </section>

    <!-- Section Exp√©riences professionnelles -->
    <section id="experience">
        <h2>Exp√©riences professionnelles</h2>
        <ul class="experience-list">
            <li>
                <img src="pjcci_logo.png" alt="Logo PJCCI" class="company-logo">
                <strong>Technicien en informatique N2 et N3</strong> - PJCCI, Montr√©al (2023 ‚Äì actuel)
            </li>
            <li>
                <img src="drill_logo.png" alt="Logo DRILL" class="company-logo">
                <strong>Technicien en informatique N1</strong> - DRILL, Laval (2022 - 2023)
            </li>
            <li>
                <img src="techriders_logo.png" alt="Logo TechRiders" class="company-logo">
                <strong>Technicien en informatique sp√©cialis√©</strong> - TechRiders, France (2021 - 2022)
            </li>
            <li>
                <img src="gouvernement_tunisie_logo.png" alt="Logo Gouvernement Tunisie" class="company-logo">
                <strong>Technicien informatique N2</strong> - Gouvernement Tunisie, Tunisie (2015 - 2021)
            </li>
        </ul>
    </section>

    <!-- Section Formations -->
    <section id="education">
        <h2>Formations</h2>
        <ul>
            <li><strong>AEC en gestion d‚Äôinfrastructure TI et Infonuagique</strong> - Coll√®ge Lionel-Groulx, Montr√©al (2024)</li>
            <li><strong>Baccalaur√©at en R√©seaux et Syst√®mes T√©l√©com</strong> - ISET‚ÄôCom, Tunisie (2015)</li>
        </ul>
    </section>

    <!-- Section Certifications -->
    <section id="certifications">
        <h2>Certifications professionnelles</h2>
        <ul class="certification-list">
            <li>
                <a href="https://www.coursera.org/account/accomplishments/specialization/certificate/Z2ODSDMM1WJ5" target="_blank" rel="noopener noreferrer">
                    <img src="ibm_logo.png" alt="Logo IBM" class="certification-logo">
                    <strong>Certificat IBM IT Support</strong> (2025)
                </a>
            </li>
            <li>
                <a href="https://www.coursera.org/account/accomplishments/specialization/certificate/V2YQ7K7TS7AP" target="_blank" rel="noopener noreferrer">
                    <img src="microsoft_logo.png" alt="Logo Microsoft" class="certification-logo">
                    <strong>Certificat Microsoft IT Support Specialist</strong> (2024)
                </a>
            </li>
            <li>
                <a href="https://www.coursera.org/account/accomplishments/specialization/certificate/YI5KZ71ZGAZ7" target="_blank" rel="noopener noreferrer">
                    <img src="google_logo.png" alt="Logo Google" class="certification-logo">
                    <strong>Certificat Google IT Support</strong> (2024)
                </a>
            </li>
        </ul>
    </section>

    <!-- Section Comp√©tences -->
    <section id="skills">
        <h2>Comp√©tences</h2>
        <h3>Support aux utilisateurs et assistance technique :</h3>
        <ul>
            <li>Fournir un soutien informatique de niveau 1, 2 et 3 aux utilisateurs internes, incluant la r√©solution de probl√®mes complexes n√©cessitant une analyse approfondie des syst√®mes.</li>
            <li>R√©pondre aux appels et tickets d‚Äôincidents via le syst√®me de billetterie Octopus, en veillant √† documenter chaque intervention pour assurer le suivi.</li>
            <li>Effectuer une assistance √† distance pour diagnostiquer et r√©soudre les probl√®mes mat√©riels et logiciels, souvent via des outils comme Microsoft Remote Desktop, Sccm et TeamViewer.</li>
            <li>Assurer un service √† la client√®le de qualit√©, en s‚Äôassurant de r√©pondre rapidement aux demandes, avec une communication claire et concise.</li>
            <li>Assurer le d√©pannage des logiciels et la r√©paration du mat√©riel informatique (PC, ordinateurs portables, imprimantes, r√©seaux).</li>
            <li>R√©aliser des r√©visions d‚Äôacc√®s, en analysant et ajustant les droits d‚Äôacc√®s des utilisateurs dans les syst√®mes d‚Äôinformation pour maintenir la s√©curit√©.</li>
            <li>Supporter les utilisateurs dans l'utilisation de Microsoft 365, en assurant la gestion des acc√®s et des droits au sein de Microsoft Office et Microsoft Access.</li>
            <li>G√©rer les comptes utilisateurs, les groupes d‚Äôacc√®s et les objets dans Active Directory, incluant la cr√©ation, la modification et la suppression des comptes.</li>
            <li>Assister √† la configuration du jeton virtuel pour les utilisateurs n√©cessitant un acc√®s s√©curis√© aux ressources r√©seau.</li>
        </ul>

        <h3>Gestion des comptes et des acc√®s :</h3>
        <ul>
            <li>Cr√©er, modifier, archiver et supprimer les comptes utilisateurs dans Active Directory (AD) et Azure AD, en assurant une gestion compl√®te du cycle de vie des comptes.</li>
            <li>Utiliser l‚ÄôAD Manager pour automatiser et faciliter la gestion des comptes et des groupes, tout en s‚Äôassurant que les droits d‚Äôacc√®s sont conformes aux politiques de s√©curit√© de l‚Äôentreprise.</li>
            <li>G√©rer des comptes et licences Adobe via la Console d‚Äôadministration, en veillant √† l‚Äôattribution correcte des licences pour les logiciels tels qu‚ÄôAdobe Creative Cloud et Acrobat.</li>
            <li>Administrer de la suite Microsoft 365, incluant la gestion d‚ÄôExchange pour les bo√Ætes aux lettres, Intune pour la gestion des appareils mobiles (MDM), Teams pour la collaboration, et Azure pour la gestion des utilisateurs et des acc√®s.</li>
        </ul>
    </section>

    <!-- Section T√©moignages -->
    <section id="testimonials">
        <h2>T√©moignages</h2>
        <div class="testimonial-list">
            <div class="testimonial-item">
                <p>"Marwen a r√©solu un probl√®me complexe sur notre r√©seau en un temps record. Je le recommande vivement !"</p>
                <p class="author">- Jean Dupont, Directeur IT</p>
            </div>
            <div class="testimonial-item">
                <p>"Un professionnel comp√©tent et r√©actif. Merci pour votre excellent support technique !"</p>
                <p class="author">- Marie Curie, Gestionnaire de projet</p>
            </div>
        </div>
    </section>

    <!-- Section Contact -->
    <section id="contact">
        <h2>Contactez-moi</h2>
        <p>Vous avez un probl√®me technique √† r√©soudre ? Contactez-moi d√®s aujourd'hui !</p>
        <ul class="contact-info">
            <li><strong>T√©l√©phone :</strong> <a href="tel:+14385263603">+1 438 526 3603</a></li>
            <li><strong>Email :</strong> <a href="mailto:marouenbenslimen88@gmail.com">marouenbenslimen88@gmail.com</a></li>
        </ul>
        <form action="https://formspree.io/f/xovvppzg" method="POST">
            <label for="name">Nom :</label>
            <input type="text" id="name" name="name" required>
            <label for="email">Email :</label>
            <input type="email" id="email" name="email" required>
            <label for="message">Message :</label>
            <textarea id="message" name="message" rows="4" required></textarea>
            <button type="submit">Envoyer</button>
        </form>
    </section>

    <footer>
        <p>&copy; 2025 - Marwen Ben Slimen. Tous droits r√©serv√©s.</p>
        <p><strong>T√©l√©phone :</strong> <a href="tel:+14385263603">+1 438 526 3603</a> | <strong>Email :</strong> <a href="mailto:marouenbenslimen88@gmail.com">marouenbenslimen88@gmail.com</a></p>
    </footer>
    <script src="script.js"></script>
    <!-- Section Commentaires -->
<section id="comments">
    <h2>Laissez un commentaire</h2>
    <form id="comment-form">
        <label for="comment-name">Nom :</label>
        <input type="text" id="comment-name" name="comment-name" required>
        
        <label for="comment-email">Email :</label>
        <input type="email" id="comment-email" name="comment-email" required>
        
        <label for="comment-text">Commentaire :</label>
        <textarea id="comment-text" name="comment-text" rows="4" required></textarea>
        
        <label for="rating">Note :</label>
        <select id="rating" name="rating">
            <option value="1">1 √©toile</option>
            <option value="2">2 √©toiles</option>
            <option value="3">3 √©toiles</option>
            <option value="4">4 √©toiles</option>
            <option value="5">5 √©toiles</option>
        </select>
        
        <button type="submit">Envoyer</button>
    </form>
    <div id="comment-list"></div>
</section>
    <!-- Section Ressources -->
<section id="ressources">
    <h2>Ressources Utiles</h2>
    <ul>
        <li><a href="https://www.freecodecamp.org/" target="_blank">FreeCodeCamp</a> - Apprenez √† coder gratuitement.</li>
        <li><a href="https://www.coursera.org/" target="_blank">Coursera</a> - Cours en ligne certifiants.</li>
        <li><a href="https://github.com/" target="_blank">GitHub</a> - Plateforme de d√©veloppement collaboratif.</li>
        <li><a href="https://stackoverflow.com/" target="_blank">Stack Overflow</a> - Forum pour les d√©veloppeurs.</li>
        <li><a href="https://www.udemy.com/" target="_blank">Udemy</a> - Cours en ligne payants.</li>
    </ul>
</section>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <li><i class="fas fa-code"></i> <a href="https://www.freecodecamp.org/" target="_blank">FreeCodeCamp</a></li>
    <!-- ===== IA Engine (Transformers.js) ===== -->
<script src="https://cdn.jsdelivr.net/npm/@xenova/transformers/dist/transformers.min.js"></script>

<!-- ===== Chatbot IA (Marwen IT Help) ===== -->
<div id="itbot-root" aria-live="polite">
  <!-- Bouton flottant (visible quand la fen√™tre est ferm√©e) -->
  <button id="itbot-toggle" aria-haspopup="dialog" aria-controls="itbot-window" aria-label="Ouvrir le chatbot">
    <i class="fa-solid fa-comments" aria-hidden="true"></i>
    <span class="itbot-fallback" aria-hidden="true">üí¨</span>
  </button>

  <!-- Fen√™tre de chat -->
  <div id="itbot-window" role="dialog" aria-modal="false" aria-labelledby="itbot-title" hidden>
    <header class="itbot-header">
      <div>
        <strong id="itbot-title">Marwen ‚Äì Aide IT (IA locale)</strong>
        <div class="itbot-subtitle">Wi-Fi, imprimantes, AD, VPN, Outlook, Teams‚Ä¶</div>
      </div>
      <button id="itbot-close" aria-label="Fermer (√âchap)">
        <i class="fa-solid fa-xmark" aria-hidden="true"></i>
      </button>
    </header>

    <main id="itbot-messages" class="itbot-scroll" tabindex="0" aria-label="Fil des messages">
      <div class="itbot-msg itbot-bot">
        üëã Bonjour ! Je charge le mod√®le IA la premi√®re fois (quelques centaines de Mo).
        Pose ta question, je r√©ponds d√®s que je suis pr√™t.
      </div>
    </main>

    <div class="itbot-suggestions" aria-label="Suggestions rapides">
      <button class="itbot-chip">Je n‚Äôarrive pas √† me connecter au Wi-Fi</button>
      <button class="itbot-chip">Mon mot de passe AD ne fonctionne pas</button>
      <button class="itbot-chip">Ajouter une imprimante r√©seau</button>
      <button class="itbot-chip">Le VPN ne se connecte pas</button>
      <button class="itbot-chip">Outlook ne synchronise pas</button>
      <button class="itbot-chip">Teams cam√©ra/micro</button>
    </div>

    <form id="itbot-form" autocomplete="off">
      <input id="itbot-input" type="text" placeholder="√âcrivez votre question‚Ä¶" aria-label="Votre question" required />
      <button id="itbot-send" type="submit" aria-label="Envoyer">
        <i class="fa-solid fa-paper-plane" aria-hidden="true"></i>
      </button>
    </form>

    <footer class="itbot-footer">
      <small>Besoin d‚Äôun humain ? <a href="#contact" class="itbot-link">Contactez-moi</a></small>
    </footer>
  </div>
</div>

<style>
/* Positionnement + accessibilit√© */
#itbot-root { position: fixed; bottom: 24px; right: 24px; z-index: 9999; font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Noto Sans",sans-serif; }
#itbot-root.open #itbot-toggle { display: none; }  /* cache le bouton quand la fen√™tre est ouverte */

#itbot-toggle {
  width:56px; height:56px; border-radius:50%; border:none; cursor:pointer; display:grid; place-items:center;
  color:#fff; background:linear-gradient(135deg,#2563eb,#0ea5e9); box-shadow:0 10px 20px rgba(0,0,0,.18);
}
#itbot-toggle i { font-size: 20px; }
#itbot-toggle .itbot-fallback { font-size:22px; line-height:1; }

#itbot-window {
  position: fixed; bottom:92px; right:24px; width:min(380px,92vw); max-height:min(70vh,760px);
  background:#fff; border-radius:16px; border:1px solid #e5e7eb; box-shadow:0 20px 50px rgba(0,0,0,.25);
  display:flex; flex-direction:column; overflow:hidden;
}
.itbot-header { display:flex; align-items:center; justify-content:space-between; padding:12px 14px; background:#0ea5e9; color:#fff; }
.itbot-subtitle{ font-size:.85rem; opacity:.9; }
#itbot-close { background:transparent; border:none; color:#fff; cursor:pointer; font-size:1.15rem; }

#itbot-messages { padding:12px; gap:10px; display:flex; flex-direction:column; background:#f8fafc; overflow:auto; }
.itbot-msg { max-width:88%; padding:10px 12px; border-radius:12px; line-height:1.35; font-size:.95rem; white-space:pre-wrap; }
.itbot-bot  { background:#e2f2ff; border:1px solid #bfdbfe; color:#0f172a; align-self:flex-start; }
.itbot-user { background:#e5e7eb; border:1px solid #d1d5db; color:#111827; align-self:flex-end; }
.itbot-typing { opacity:.8; font-style:italic; }

.itbot-suggestions { display:flex; flex-wrap:wrap; gap:8px; padding:8px 12px; background:#fff; border-top:1px solid #eef2f7; }
.itbot-chip { border:1px solid #dbeafe; background:#f0f9ff; color:#0c4a6e; padding:6px 10px; border-radius:999px; cursor:pointer; font-size:.85rem; }

#itbot-form { display:flex; gap:8px; padding:10px; background:#fff; border-top:1px solid #eef2f7; }
#itbot-input { flex:1; padding:10px 12px; border-radius:10px; border:1px solid #cbd5e1; font-size:.95rem; }
#itbot-send { width:44px; border-radius:10px; border:1px solid #bae6fd; background:#e0f2fe; color:#075985; cursor:pointer; }
#itbot-send[disabled] { opacity:.6; cursor:not-allowed; }

.itbot-footer { padding:6px 12px 10px; background:#fff; border-top:1px solid #eef2f7; text-align:right; }
.itbot-link { color:#0ea5e9; text-decoration: underline; }

@media (prefers-reduced-motion:no-preference){
  #itbot-window{ animation: itbot-pop .18s ease-out; }
  @keyframes itbot-pop { from{ transform: translateY(8px); opacity:.0 } to{ transform: translateY(0); opacity:1 } }
}
</style>

<script>
(function(){
  const el = {
    root:   document.getElementById('itbot-root'),
    toggle: document.getElementById('itbot-toggle'),
    win:    document.getElementById('itbot-window'),
    close:  document.getElementById('itbot-close'),
    messages: document.getElementById('itbot-messages'),
    form:   document.getElementById('itbot-form'),
    input:  document.getElementById('itbot-input'),
    send:   document.getElementById('itbot-send'),
    chips:  document.querySelectorAll('.itbot-chip'),
  };

  /* ==== √âTAT IA ==== */
  let pipe = null;
  let loading = false;
  let ready = false;

  const SYSTEM_PROMPT = `You are "Marwen IT Assistant", a concise and practical IT helpdesk chatbot.
Answer in the user's language (French if the user writes in French). Topics: Wi-Fi, printers, AD, VPN, Outlook/Teams, Windows, RSAT.
Give short, step-by-step guidance, commands in code blocks. Never ask for passwords. If unclear, ask one short question then give a first step.`;

  // Mini FAQ de secours (si IA non pr√™te)
  const FALLBACK = [
    { tags: /wifi|wi-?fi|internet|r√©seau|reseau/i,
      ans: `üí° Wi-Fi (Windows)
1) Win+A ‚Üí Mode avion d√©sactiv√©
2) Param√®tres > R√©seau > Wi-Fi ON
3) Oublier puis se reconnecter au SSID
4) CMD (Admin):
   netsh winsock reset
   ipconfig /flushdns
5) Red√©marrer PC et routeur.` },
    { tags: /imprim/i,
      ans: `üñ®Ô∏è Ajouter une imprimante
Param√®tres > Bluetooth et appareils > Imprimantes et scanners > Ajouter.
R√©seau : \\\\serveur\\NomImprimante ou IP (port TCP/IP).
Installer le pilote constructeur si demand√©.` },
    { tags: /vpn|forti|anyconnect|globalprotect/i,
      ans: `üåê VPN
- V√©rifier identifiants + MFA
- Horloge syst√®me correcte
- Tester un autre r√©seau
- Relancer l'app VPN / red√©marrer` },
    { tags: /outlook|courriel|mail/i,
      ans: `üìß Outlook
- R√©parer Office (Panneau de config > Programmes > Office > Modifier > R√©parer)
- Nouveau profil (Panneau de config > Courrier > Profils)
- Bo√Æte partag√©e : Fichier > Comptes > Ajouter bo√Æte partag√©e` },
    { tags: /teams|cam(√©|e)ra|micro/i,
      ans: `üé• Teams
- Param√®tres > P√©riph√©riques ‚Üí choisir micro/cam√©ra
- Quitter compl√®tement et relancer
- Vider cache (Win+R): %appdata%\\Microsoft\\Teams\\Cache` },
    { tags: /mot ?de ?passe|password|ad\b|active ?directory/i,
      ans: `üîê Mot de passe AD
- Ctrl+Alt+Suppr > Modifier le mot de passe
- Sinon: r√©initialisation par l'admin (complexit√©)
- Hors domaine : connecter le VPN pour valider` },
  ];

  /* ==== UI helpers ==== */
  const open = () => {
    el.win.hidden = false;
    el.root.classList.add('open');
    el.input.focus();
    loadModel(); // charge l'IA au premier open
  };
  const close = () => {
    el.win.hidden = true;
    el.root.classList.remove('open');
    el.toggle.focus();
  };
  const push = (text, who, extraClass='') => {
    const d = document.createElement('div');
    d.className = `itbot-msg itbot-${who} ${extraClass}`;
    d.textContent = text;
    el.messages.appendChild(d);
    el.messages.scrollTop = el.messages.scrollHeight;
    return d;
  };

  /* ==== IA ==== */
  async function loadModel(){
    if (loading || ready) return;
    loading = true;
    try {
      pipe = await window.transformers.pipeline(
        "text-generation",
        "Xenova/Qwen2.5-0.5B-Instruct",
        { quantized: true }
      );
      ready = true;
      push("‚úÖ IA pr√™te. Posez votre question IT.", "bot");
    } catch (e){
      console.error("Transformers load error:", e);
      push("‚ùå Erreur de chargement du mod√®le. Je peux tout de m√™me te guider avec des conseils de base.", "bot");
    } finally {
      loading = false;
    }
  }

  async function aiAnswer(userText){
    // garde UX fluide si IA pas pr√™te
    if (!pipe && !loading) loadModel();

    // Si au bout de 20s pas pr√™t ‚Üí fallback
    const timeout = (ms) => new Promise(res => setTimeout(res, ms));
    let waited = 0;
    while(!ready && waited < 20000 && loading) { await timeout(250); waited += 250; }

    if (!ready) {
      // R√©ponse de secours
      const hit = FALLBACK.find(f => f.tags.test(userText));
      return hit ? hit.ans : `ü§ñ Je ne suis pas encore pr√™t. Essaie des mots-cl√©s (Wi-Fi, imprimante, VPN, Outlook, Teams, AD).
Sinon, utilise la section Contact et je te r√©ponds rapidement.`;
    }

    // G√©n√©ration IA
    const prompt = `System: ${SYSTEM_PROMPT}\nUser: ${userText}\nAssistant:`;
    try {
      const out = await pipe(prompt, {
        max_new_tokens: 180,
        temperature: 0.2,
        top_p: 0.9,
        repetition_penalty: 1.05
      });
      const full = (Array.isArray(out)? out[0].generated_text : String(out));
      return full.split("Assistant:").pop().trim();
    } catch (e){
      console.error("Generation error:", e);
      return "‚ö†Ô∏è Une erreur est survenue pendant la g√©n√©ration. R√©essaie ou pr√©cise ta question.";
    }
  }

  /* ==== Events ==== */
  el.toggle.addEventListener('click', open);
  el.close.addEventListener('click', close);
  document.addEventListener('keydown', (e)=>{ if (e.key === 'Escape' && !el.win.hidden) close(); });

  el.form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    const q = el.input.value.trim();
    if(!q) return;
    el.input.value = '';
    el.send.disabled = true;

    push(q, 'user');
    const typing = push('‚Ä¶', 'bot', 'itbot-typing');

    const a = await aiAnswer(q);
    typing.remove();
    push(a, 'bot');
    el.send.disabled = false;
  });

  el.chips.forEach(ch => ch.addEventListener('click', async ()=>{
    const q = ch.textContent.trim();
    open();
    el.input.value = q;
    el.form.requestSubmit();
  }));
})();
</script>
<script>
(function(){
  const el = {
    root:   document.getElementById('itbot-root'),
    toggle: document.getElementById('itbot-toggle'),
    win:    document.getElementById('itbot-window'),
    close:  document.getElementById('itbot-close'),
    messages: document.getElementById('itbot-messages'),
    form:   document.getElementById('itbot-form'),
    input:  document.getElementById('itbot-input'),
    send:   document.getElementById('itbot-send'),
    chips:  document.querySelectorAll('.itbot-chip'),
  };

  // ---- √©tat IA ----
  let pipe=null, loading=false, ready=false;

  const SYSTEM_PROMPT = `You are "Marwen IT Assistant", a concise and practical IT helpdesk chatbot.
Answer in the user's language (French if the user writes in French). Topics: Wi-Fi, printers, AD, VPN, Outlook/Teams, Windows.
Give short, step-by-step guidance, commands in code blocks. Never ask for passwords.`;

  // Fallback simple si le mod√®le n'est pas pr√™t
  const FALLBACK = [
    { re:/wifi|wi-?fi|internet|r√©seau|reseau/i, ans:`üí° Wi-Fi (Windows)\n1) Win+A Mode avion OFF\n2) Param√®tres > R√©seau > Wi-Fi ON\n3) Oublier puis reconnecter\n4) CMD (Admin):\n   netsh winsock reset\n   ipconfig /flushdns\n5) Red√©marrer PC + routeur`},
    { re:/imprim/i,  ans:`üñ®Ô∏è Ajouter une imprimante\nParam√®tres > Bluetooth et appareils > Imprimantes et scanners > Ajouter.\nR√©seau: \\\\serveur\\Nom ou IP (TCP/IP)`},
    { re:/vpn|forti|anyconnect|globalprotect/i, ans:`üåê VPN\n- V√©rifier identifiants + MFA\n- Horloge syst√®me OK\n- Tester un autre r√©seau\n- Relancer l'app / red√©marrer`},
  ];

  // ---- helpers UI ----
  const push = (text, who, cls='')=>{
    const d=document.createElement('div');
    d.className=`itbot-msg itbot-${who} ${cls}`;
    d.textContent=text;
    el.messages.appendChild(d);
    el.messages.scrollTop = el.messages.scrollHeight;
    return d;
  };

  const open = ()=>{
    el.win.hidden = false;
    el.root.classList.add('open');      // masque le bouton
    el.input.focus();
    loadModel();
  };

  const close = ()=>{
    el.win.hidden = true;
    el.root.classList.remove('open');   // r√©-affiche le bouton
    el.toggle.focus();
  };

  // ---- IA ----
  async function loadModel(){
    if (loading || ready) return;
    loading = true;
    try {
      pipe = await window.transformers.pipeline(
        "text-generation",
        "Xenova/Qwen2.5-0.5B-Instruct",
        { quantized: true }
      );
      ready = true;
      push("‚úÖ IA pr√™te. Posez votre question IT.", "bot");
    } catch(e){
      console.error(e);
      push("‚ùå Erreur de chargement du mod√®le. Je peux te r√©pondre avec des conseils de base.", "bot");
    } finally {
      loading = false;
    }
  }

  async function aiAnswer(q){
    if (!pipe && !loading) loadModel();

    // patiente max ~20s sinon fallback
    const wait = ms => new Promise(r=>setTimeout(r,ms));
    let waited=0;
    while(!ready && loading && waited<20000){ await wait(250); waited+=250; }

    if (!ready){
      const hit = FALLBACK.find(f=>f.re.test(q));
      return hit ? hit.ans : "Je ne suis pas encore pr√™t. Essaie un mot-cl√© (Wi-Fi, imprimante, VPN, Outlook, AD) ou contacte-moi.";
    }

    const prompt = `System: ${SYSTEM_PROMPT}\nUser: ${q}\nAssistant:`;
    try {
      const out = await pipe(prompt, { max_new_tokens:180, temperature:0.2, top_p:0.9, repetition_penalty:1.05 });
      const full = Array.isArray(out) ? out[0].generated_text : String(out);
      return full.split("Assistant:").pop().trim();
    } catch(e){
      console.error(e);
      return "‚ö†Ô∏è Erreur pendant la g√©n√©ration. R√©essaie.";
    }
  }

  // ---- events ----
  el.toggle.addEventListener('click', open);
  el.close.addEventListener('click', close);
  document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && !el.win.hidden) close(); });

  el.form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    const q = el.input.value.trim();
    if(!q) return;
    el.input.value='';
    el.send.disabled = true;

    push(q,'user');
    const typing = push('‚Ä¶','bot','itbot-typing');
    const a = await aiAnswer(q);
    typing.remove();
    push(a,'bot');
    el.send.disabled = false;
  });

  el.chips.forEach(ch => ch.addEventListener('click', ()=>{
    el.input.value = ch.textContent.trim();
    el.form.requestSubmit();
  }));
})();
</script>

</body>
</html>



